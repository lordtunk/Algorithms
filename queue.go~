package main

import "fmt"

type item struct {
	data int
	next *item
}
type queue struct {
	count int
	first *item
	last *item
}

func main() {
	q := initQueue()
	q.enqueue(1)
	q.enqueue(2)
	q.enqueue(3)
	q.print()
	q.dequeue()
	q.print()
	q.dequeue()
	q.print()
	q.dequeue()
	q.print()
}

func (q *queue) enqueue(data int) {
	i := initItem(data)
	if q.count == 0 {
		q.first = i
		q.last = i
	} else {
		q.last.next = i
		q.last = i
	}
	q.count = q.count + 1
}

func (q *queue) dequeue() (*item) {
	if q.count == 0 {
		return nil
	}
	i := q.first
	q.first = i.next
	q.count = q.count - 1
	return i
}

// Output each item in the queue
func (q *queue) print() {
	if q.count == 0 {
		out("queue is empty\n")
	}
	i := q.first
	for count := 0; i != nil && count < q.count; count++ {
		out("%d ", i.data)
		i = i.next
	}
	out("\n")
}

func initQueue() (*queue) {
	q := new(queue)
	q.count = 0
	q.first = nil
	q.last = nil
	return q
}
func initItem(data int) (*item) {
	i := new(item)
	i.data = data
	i.next = nil
	return i
}

func out(format string, v...interface{}) {
	fmt.Printf(format, v...)
}